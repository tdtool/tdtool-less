{"version":3,"sources":["../src/index.js"],"names":["loadTheme","theme","String","require","Object","module","exports","config","options","cssLoader","loader","target","sourceMap","modules","localIdentName","minimize","discardComments","removeAll","postcssLoader","plugins","Array","postCss","autoprefixer","browsers","lessLoader","modifyVars","add","test","use","extractCss","extract","fallback"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @Author: Zhengfeng.Yao <yzf>\n * @Date:   2017-05-03 15:53:34\n * @Last modified by:   yzf\n * @Last modified time: 2017-05-03 15:55:49\n */\n\nimport ExtractTextPlugin from 'extract-text-webpack-plugin'\n\nimport is from './is'\n\nfunction loadTheme(theme) {\n  if (is.String(theme)) {\n    return require(theme)\n  }\n  if (is.Object(theme)) {\n    return theme\n  }\n  return null\n}\n\nmodule.exports = (config, options) => {\n  const cssLoader = {\n    loader: `css-loader${is.Object(options) && options.target === 'node' ? '/locals' : ''}`,\n    options: {\n      sourceMap: is.Object(options) && !!options.sourceMap,\n      modules: true,\n      localIdentName: '[local]',\n      minimize: is.Object(options) && options.target !== 'node' && !!options.minimize,\n      discardComments: { removeAll: true }\n    }\n  }\n  const postcssLoader = {\n    loader: 'postcss-loader',\n    options: {\n      plugins: () => {\n        if (is.Object(options) && is.Array(options.postCss)) {\n          return options.postCss\n        }\n        return [\n          require('postcss-nested')(),\n          require('pixrem')(),\n          require('autoprefixer')(is.Object(options) && is.Object(options.autoprefixer) ? options.autoprefixer : {\n            browsers: [\n              'Chrome >= 35',\n              'Firefox >= 31',\n              'Explorer >= 9',\n              'Opera >= 12',\n              'Safari >= 7.1'\n            ]\n          }),\n          require('postcss-flexibility')(),\n          require('postcss-discard-duplicates')()\n        ]\n      }\n    }\n  }\n  const lessLoader = {\n    loader: 'less-loader',\n    options: {\n      sourceMap: is.Object(options) && !!options.sourceMap,\n      modifyVars: is.Object(options) ? loadTheme(options.theme) : null\n    }\n  }\n\n  if (is.Object(options) && options.target === 'node') {\n    config.add('rule.less', {\n      test: /\\.less$/,\n      use: [\n        cssLoader,\n        postcssLoader,\n        lessLoader\n      ]\n    })\n    config.add('rule.css', {\n      test: /\\.css$/,\n      use: [\n        cssLoader,\n        postcssLoader\n      ]\n    })\n    return\n  }\n  if (is.Object(options) && !!options.extractCss) {\n    config.add('plugin.ExtractText', new ExtractTextPlugin(is.String(options.extractCss) ? options.extractCss : '[name].css'))\n    config.add('rule.less', {\n      test: /\\.less$/,\n      use: ExtractTextPlugin.extract({\n        fallback: 'style-loader',\n        use: [\n          cssLoader,\n          postcssLoader,\n          lessLoader\n        ]\n      })\n    })\n    config.add('rule.css', {\n      test: /\\.css$/,\n      use: ExtractTextPlugin.extract({\n        fallback: 'style-loader',\n        use: [\n          cssLoader,\n          postcssLoader\n        ]\n      })\n    })\n    return\n  }\n\n  config.add('rule.less', {\n    test: /\\.less$/,\n    use: [\n      'style-loader',\n      cssLoader,\n      postcssLoader,\n      lessLoader\n    ]\n  })\n  config.add('rule.css', {\n    test: /\\.css$/,\n    use: [\n      'style-loader',\n      cssLoader,\n      postcssLoader\n    ]\n  })\n}\n"]}