{"version":3,"sources":["../src/index.js"],"names":["loadTheme","theme","String","require","Object","URL_LOADER_LIMIT","staticLoader","config","options","add","test","loader","query","limit","urlLoaderLimit","minetype","module","exports","cssLoader","target","sourceMap","modules","localIdentName","minimize","discardComments","removeAll","postcssLoader","plugins","Array","postCss","autoprefixer","browsers","lessLoader","modifyVars","use","extractCss","extract","fallback"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @Author: Zhengfeng.Yao <yzf>\n * @Date:   2017-05-03 15:53:34\n * @Last modified by:   yzf\n * @Last modified time: 2017-05-03 15:55:49\n */\n\nimport ExtractTextPlugin from 'extract-text-webpack-plugin'\n\nimport is from './is'\n\nfunction loadTheme(theme) {\n  if (is.String(theme)) {\n    return require(theme)\n  }\n  if (is.Object(theme)) {\n    return theme\n  }\n  return null\n}\n\nconst URL_LOADER_LIMIT = 10000\n\nfunction staticLoader(config, options) {\n  config.add('rule.txt', {\n    test: /\\.txt$/,\n    loader: 'raw-loader'\n  })\n  config.add('rule.woff', {\n    test: /\\.woff(\\?v=\\d+\\.\\d+\\.\\d+)?$/,\n    loader: 'url-loader',\n    query: {\n      limit: options && options.urlLoaderLimit ? options.urlLoaderLimit : URL_LOADER_LIMIT,\n      minetype: 'application/font-woff'\n    }\n  })\n  config.add('rule.woff2', {\n    test: /\\.woff2(\\?v=\\d+\\.\\d+\\.\\d+)?$/,\n    loader: 'url-loader',\n    query: {\n      limit: options && options.urlLoaderLimit ? options.urlLoaderLimit : URL_LOADER_LIMIT,\n      minetype: 'application/font-woff'\n    }\n  })\n  config.add('rule.ttf', {\n    test: /\\.ttf(\\?v=\\d+\\.\\d+\\.\\d+)?$/,\n    loader: 'url-loader',\n    query: {\n      limit: options && options.urlLoaderLimit ? options.urlLoaderLimit : URL_LOADER_LIMIT,\n      minetype: 'application/octet-stream'\n    }\n  })\n  config.add('rule.eot', {\n    test: /\\.eot(\\?v=\\d+\\.\\d+\\.\\d+)?$/,\n    loader: 'file-loader'\n  })\n  config.add('rule.svg', {\n    test: /\\.svg(\\?v=\\d+\\.\\d+\\.\\d+)?$/,\n    loader: 'url-loader',\n    query: {\n      limit: options && options.urlLoaderLimit ? options.urlLoaderLimit : URL_LOADER_LIMIT,\n      minetype: 'image/svg+xml'\n    }\n  })\n  config.add('rule.IMAGE', {\n    test: /\\.(png|jpg|jpeg|gif)(\\?v=\\d+\\.\\d+\\.\\d+)?$/i,\n    loader: 'url-loader',\n    query: {\n      limit: options && options.urlLoaderLimit ? options.urlLoaderLimit : URL_LOADER_LIMIT\n    }\n  })\n}\n\nmodule.exports = (config, options) => {\n  staticLoader(config, options)\n  const cssLoader = {\n    loader: `css-loader${is.Object(options) && options.target === 'node' ? '/locals' : ''}`,\n    options: {\n      sourceMap: is.Object(options) && !!options.sourceMap,\n      modules: true,\n      localIdentName: '[local]',\n      minimize: is.Object(options) && options.target !== 'node' && !!options.minimize,\n      discardComments: { removeAll: true }\n    }\n  }\n  const postcssLoader = {\n    loader: 'postcss-loader',\n    options: {\n      plugins: () => {\n        if (is.Object(options) && is.Array(options.postCss)) {\n          return options.postCss\n        }\n        return [\n          require('postcss-nested')(),\n          require('pixrem')(),\n          require('autoprefixer')(is.Object(options) && is.Object(options.autoprefixer) ? options.autoprefixer : {\n            browsers: [\n              'Chrome >= 35',\n              'Firefox >= 31',\n              'Explorer >= 9',\n              'Opera >= 12',\n              'Safari >= 7.1'\n            ]\n          }),\n          require('postcss-flexibility')(),\n          require('postcss-discard-duplicates')()\n        ]\n      }\n    }\n  }\n  const lessLoader = {\n    loader: 'less-loader',\n    options: {\n      sourceMap: is.Object(options) && !!options.sourceMap,\n      modifyVars: is.Object(options) ? loadTheme(options.theme) : null\n    }\n  }\n\n  if (is.Object(options) && options.target === 'node') {\n    config.add('rule.less', {\n      test: /\\.less$/,\n      use: [\n        cssLoader,\n        postcssLoader,\n        lessLoader\n      ]\n    })\n    config.add('rule.css', {\n      test: /\\.css$/,\n      use: [\n        cssLoader,\n        postcssLoader\n      ]\n    })\n    return\n  }\n  if (is.Object(options) && !!options.extractCss) {\n    config.add('plugin.ExtractText', new ExtractTextPlugin(is.String(options.extractCss) ? options.extractCss : '[name].css'))\n    config.add('rule.less', {\n      test: /\\.less$/,\n      use: ExtractTextPlugin.extract({\n        fallback: 'style-loader',\n        use: [\n          cssLoader,\n          postcssLoader,\n          lessLoader\n        ]\n      })\n    })\n    config.add('rule.css', {\n      test: /\\.css$/,\n      use: ExtractTextPlugin.extract({\n        fallback: 'style-loader',\n        use: [\n          cssLoader,\n          postcssLoader\n        ]\n      })\n    })\n    return\n  }\n\n  config.add('rule.less', {\n    test: /\\.less$/,\n    use: [\n      'style-loader',\n      cssLoader,\n      postcssLoader,\n      lessLoader\n    ]\n  })\n  config.add('rule.css', {\n    test: /\\.css$/,\n    use: [\n      'style-loader',\n      cssLoader,\n      postcssLoader\n    ]\n  })\n}\n"]}